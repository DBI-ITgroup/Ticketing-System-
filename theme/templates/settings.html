{% extends "base.html" %}
{% load heroicons %}

{% block title %}Settings{% endblock %}

{% block sidebar %}
<nav class="flex flex-col h-full bg-gray-50 w-64 p-4">
    <div class="mb-8 rounded-xl shadow bg-white p-4 text-center">
        <h2 class="text-xl font-bold text-gray-800">Settings</h2>
    </div>
    <ul class="flex-1 space-y-2"></ul>
    <div class="mt-auto">
        <a href="{% url 'logout' %}" class="flex items-center gap-2 px-3 py-2 rounded bg-gray-700 text-white hover:bg-red-600 transition">
            {% heroicon_outline "arrow-left-start-on-rectangle" %} Logout
        </a>
    </div>
</nav>
{% endblock %}

{% block content %}
<div class="flex min-h-screen">

    <!-- Main Form -->
    <div class="flex-1 bg-gray-100 p-6 relative">

        <!-- Success/Error Popup -->
        <div x-data="{ show: true }" x-show="show" 
             x-transition 
             x-init="setTimeout(() => show = false, 3000)"
             class="fixed top-5 right-5 z-50 space-y-2"
             style="display: none;">
            {% for message in messages %}
                <div class="px-4 py-2 rounded shadow-lg
                    {% if message.tags == 'success' %} bg-green-600 text-white
                    {% elif message.tags == 'error' %} bg-red-600 text-white
                    {% elif message.tags == 'info' %} bg-blue-600 text-white
                    {% else %} bg-gray-600 text-white {% endif %}">
                    {{ message }}
                </div>
            {% endfor %}
        </div>

        <div class="bg-white shadow-md rounded-lg p-6 max-w-md">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">Reset Your Password</h2>
            
            <form method="POST" action="{% url 'settings-page' %}" class="space-y-4 text-left">
                {% csrf_token %}
                
                <!-- Full Name (disabled) -->
                <div>
                    <label class="block text-gray-700 font-semibold mb-1">Full Name</label>
                    <input type="text" value="{{ user.full_name }}" 
                        class="w-full border border-gray-300 rounded px-3 py-2 bg-gray-100 text-gray-700"
                        disabled>
                </div>

                <!-- Email (disabled) -->
                <div>
                    <label class="block text-gray-700 font-semibold mb-1">Email</label>
                    <input type="email" value="{{ user.email }}" 
                           class="w-full border border-gray-300 rounded px-3 py-2 bg-gray-100 text-gray-700"
                           disabled>
                </div>

                <!-- New Password -->
                <div>
                    <label for="id_new_password1" class="block text-gray-700 font-semibold mb-1">New Password</label>
                    <input type="password" name="new_password1" id="id_new_password1" 
                           class="w-full border border-gray-300 rounded px-3 py-2 text-gray-700" required>
                </div>

                <!-- Confirm New Password -->
                <div>
                    <label for="id_new_password2" class="block text-gray-700 font-semibold mb-1">Confirm New Password</label>
                    <input type="password" name="new_password2" id="id_new_password2" 
                           class="w-full border border-gray-300 rounded px-3 py-2 text-gray-700" required>
                </div>

                <button type="submit" 
                        class="bg-gray-700 hover:bg-gray-500 text-white font-semibold py-1 px-3 rounded transition">
                    Update Password
                </button>
            </form>
        </div>
    </div>
</div>

<!-- Alpine.js for popup -->
<script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
{% endblock %}
